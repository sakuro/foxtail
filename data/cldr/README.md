# CLDR Localization Data

This directory contains ICU-compliant localization data extracted from Unicode CLDR (Common Locale Data Repository).

## Data Files

- `{locale}/plural_rules.yml` - Plural rules for individual locales in YAML format (207 locales)
- `{locale}/datetime_formats.yml` - Date/time formatting data for individual locales (284 locales)
- Locales are organized by locale code (e.g., `en/`, `ru/`, `ar/`, `cy/`, `br/`, `ja/`)
- Each directory can contain additional locale-specific data (future: number formats, currency formats, etc.)

## Data Generation

The localization data was generated by directly parsing Unicode CLDR data. The extraction process is available as rake tasks for easy regeneration and management.

### Using Rake Tasks

Several rake tasks are available for working with CLDR data:

```bash
# List all available CLDR rake tasks
bundle exec rake -T cldr

# Download CLDR core data (required for extraction tasks)
bundle exec rake cldr:download

# Generate plural rules from predefined data (recommended)
bundle exec rake cldr:generate_plural_rules

# Extract plural rules from downloaded CLDR data
bundle exec rake cldr:extract_plural_rules

# Extract datetime formats from downloaded CLDR data  
bundle exec rake cldr:extract_datetime_formats

# List all available locales with plural rules
bundle exec rake cldr:list_locales

# List all available locales with datetime formats
bundle exec rake cldr:list_datetime_locales

# Show plural rules for a specific locale
bundle exec rake cldr:show[en]
bundle exec rake cldr:show[ru]
bundle exec rake cldr:show[ar]

# Show datetime formats for a specific locale
bundle exec rake cldr:show_datetime[en]
bundle exec rake cldr:show_datetime[ja]

# Test plural rules for a locale with sample numbers
bundle exec rake cldr:test[en]
bundle exec rake cldr:test[ru]

# Test datetime formatting for a locale
bundle exec rake cldr:test_datetime[en]
bundle exec rake cldr:test_datetime[ja]
```

### Implementation Details

The extraction code is implemented in `lib/tasks/cldr.rake` and provides several methods:

1. **`cldr:download`** - Downloads Unicode CLDR core data (30MB+ zip file)
2. **`cldr:generate_plural_rules`** - Generates static YAML files from predefined rules (no external dependencies)
3. **`cldr:extract_plural_rules`** - Extracts plural rules from downloaded CLDR XML data
4. **`cldr:extract_datetime_formats`** - Extracts datetime formats from downloaded CLDR XML data

The rake task implementation shows the complete extraction logic and can be used as reference for understanding how the data is structured and processed.

## Data Source

- **Source**: Unicode CLDR v46
- **URL**: https://unicode.org/Public/cldr/46/core.zip
- **Generated**: 2025-09-06T03:52:16+09:00 
- **Plural Rules**: 222 locales supported (Categories: zero, one, two, few, many, other)
- **Number Formats**: 244 locales supported (Decimal, percent, currency, scientific notation)
- **Datetime Formats**: 287 locales supported (Months, weekdays, date/time patterns)

## License

The CLDR data is released under the Unicode License. See the original CLDR distribution for license details.

## Usage

This data is automatically loaded on-demand by CLDR classes:

### Plural Rules

```ruby
rules = Foxtail::CLDR::PluralRules.new("en")  # Loads data/cldr/en/plural_rules.yml
rules.select(1)  # => "one"
rules.select(2)  # => "other"

rules_ru = Foxtail::CLDR::PluralRules.new("ru")  # Loads data/cldr/ru/plural_rules.yml
rules_ru.select(2)   # => "few"
rules_ru.select(5)   # => "many"
```

### Datetime Formats

```ruby
formats = Foxtail::CLDR::DateTimeFormats.new("en")  # Loads data/cldr/en/datetime_formats.yml
formats.month_name(6, "wide")      # => "June"
formats.weekday_name("thu", "wide") # => "Thursday"
formats.date_pattern("medium")      # => "MMM d, y"

formats_ja = Foxtail::CLDR::DateTimeFormats.new("ja")  # Loads data/cldr/ja/datetime_formats.yml
formats_ja.month_name(6, "wide")    # => "6月"
formats_ja.weekday_name("thu", "wide") # => "木曜日"
```

## Notes

- **Plural Rules**: Stored as condition strings (e.g., `"i = 1 and v = 0"`)
  - Empty conditions default to catch-all `"other"` category
  - The `@integer` and `@decimal` example sections are stripped during processing
- **Datetime Formats**: Include month/weekday names in multiple widths and date/time patterns
  - Supports CLDR standard pattern tokens (EEEE, MMMM, MMM, etc.)
  - Includes Unicode-compliant spacing (e.g., \u202F narrow no-break space)
- Data is loaded on-demand per locale to minimize memory usage
- Each locale directory can be extended with additional locale data (number formats, currency formats, etc.)
- Data generation uses only standard Ruby libraries (REXML for XML parsing, YAML for output)
- No external gems needed for regeneration process